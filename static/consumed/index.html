<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="RESTClient/bootstrap/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script href="RESTClient/bootstrap/css/bootstrap.min.js"></script>
</head>
<body>
<div class="container">
<h1>Alvaro Santos Muñoz (Oil and electricity consumed)</h1><br/><br/>
<button id="loadInitialData">Load Inital Data</button> Apikey: <input id="apikey"></input></br>

Country: <input id="country"></input></br>
Year: <input id="year"></input></br>
Petroleum Cost: <input id="petroleum_cost"></input></br>
Electric Cost: <input id="electric_cost"></input></br>

<button id="ver">Ver Todos</button>
<button id="new">Añadir</button>
<button id="edit">Editar</button>
<button id="remove">Borrar</button>
<button id="buscar">Buscar</button>
<button id="removeall">Borrar Todo</button>




<table id="location" class="table">
	<thead>
    <tr>
		<th>Countries</th>
        <th>Year</th>
		<th>Petroleum Cost</th>
		<th>Electric Cost</th>
		<th></th>
		<th></th>
    </tr>
	</thead>
</table>
</div>




	
	<script>
		$("#loadInitialData").click(function(){

        var apikey = $("#apikey").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/loadInitialData?apikey="+apikey,
            type:"GET",
            contentType : "application/json"

   		     });
  		});


//SI SOLO HAY UN OBJETO EN LA BUSQUEDA DA FALLO.
  		$("#buscar").click(function(){

  		var apikey = $("#apikey").val();
        var year = $("#year").val();

		$.ajax(
		{
			type: "GET",
			url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed/' + year +'?apikey='+apikey,
			data: "{}",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			cache: false,
			success: function (data) {
				var trHTML = '';

			$.each(data, function (i, item) {
				trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
			});

			$('#location').append(trHTML);
			},
			error: function (msg) {
				alert(msg.responseText);
			}



   		 });
	});

      

  		$("#new").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();
        var petroleum_cost = $("#petroleum_cost").val();
        var electric_cost = $("#electric_cost").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey,
            type:"GET",
            data: '{"country":"'+country+'","year":'+year+',"petroleum_cost":'+petroleum_cost+',"electric_cost":'+electric_cost+'}',
            contentType : "application/json"

   		     });
  		});

  		$("#edit").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();
        var petroleum_cost = $("#petroleum_cost").val();
        var electric_cost = $("#electric_cost").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey,
            type:"PUT",
            data: '{"country":"'+country+'","year":'+year+',"petroleum_cost":'+petroleum_cost+',"electric_cost":'+electric_cost+'}',
            contentType : "application/json"

   		     });
  		});



  		$("#remove").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey,
            type:"DELETE",
            contentType : "application/json"

   		     });
  		});


 		$("#removeall").click(function(){

        var apikey = $("#apikey").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/?apikey="+apikey,
            type:"DELETE",
            contentType : "application/json"

   		     });
  		});

		$("#ver").click(function(){

		var apikey = $("#apikey").val();

		$.ajax(
		{
			type: "GET",
			url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed?apikey='+apikey,
			data: "{}",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			cache: false,
			success: function (data) {
				var trHTML = '';

			$.each(data, function (i, item) {
				trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
			});

			$('#location').append(trHTML);
			},
			error: function (msg) {
				alert(msg.responseText);
				
			}



   		 });
	});


	</script>


</body>
</html>