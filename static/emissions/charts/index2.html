<html>

<head>
      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
   
<label>Year</label>
  <select class="browser-default" id="ano" name = "ano">
    <option value="" disabled selected>Select Year</option>
    <option value="2010">2010</option>
    <option value="2011">2011</option>
    <option value="2012">2012</option>
    <option value="2013">2013</option>
    <option value="2014">2014</option>
    <option value="2015">2015</option>
  </select>

  <div>
    <a class="waves-effect waves-light btn" id="send">Send</a>

    <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="js/materialize.min.js"></script>
      
      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
   	  <script type="text/javascript">

      $("#send").click(function(){    

    var ano = $("#ano").val();


  
    var request = $.ajax({
      url: "https://sos-2016-13.herokuapp.com/api/v1/emissions/"+ano+"?apikey=eea"
    });

    request.done((dataFromServer,status) =>{

      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawSeriesChart);

    function drawSeriesChart() {

    	console.log(dataFromServer);

    	var dataForWidget = [["Country","Nitrous Oxide Emission","CO2 Emissions","Country","Year"]];

    	for(i=0; i<dataFromServer.length;i++){
          var item= dataFromServer[i];
          var itemForWidget = [item.country, item.nitrous_oxide_emissions,item.co2_emissions,item.country,item.year];
          dataForWidget.push(itemForWidget);
        }

      //var data = google.visualization.arrayToDataTable([['Country','Year','CO2 Emissions','Country','Nitrous Oxide Emission']]);
      	
     // data.push(dataForWidget);

     // console.log(dataForWidget);

     /* var options = {
        title: 'Correlation between Nitrous Oxide Emission, CO2 Emissions ' +'and Year of some world countries',
        hAxis: {title: 'Nitrous Oxide Emission'},
        vAxis: {title: 'Year'},
        bubble: {textStyle: {fontSize: 11}}
      };
	*/
      var chart = new google.visualization.BubbleChart(document.getElementById('series_chart_div'));
      chart.draw(data, options);
    };
    </script>
  </head>
  <body>
    <div id="series_chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html>