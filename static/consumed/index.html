<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="RESTClient/bootstrap/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script href="RESTClient/bootstrap/css/bootstrap.min.js"></script>
</head>
<body>
<div class="container">
<h1>Alvaro Santos Muñoz (Oil and electricity consumed)</h1><br/><br/>


<div class="col-xs-3">
Apikey:<input id="apikey" class="form-control"></input></br>

Country: <input id="country" class="form-control"></input></br>
Year: <input id="year" class="form-control"></input></br>
Petroleum Cost: <input id="petroleum_cost" class="form-control"></input></br>
Electric Cost: <input id="electric_cost" class="form-control"></input></br>
</div>
<div class="col-xs-3">
Búsqueda: </br></br>Desde <input id="desde" class="form-control"></input>   Hasta <input id="hasta" class="form-control"></input></br>
</div>
<div class="col-xs-3">
Paginación: <select id= "pag" name="pag" class="form-control">
   <option value="0">0</option> 
   <option value="1">1</option> 
   <option value="2">2</option> 
   <option value="3">3</option>
   <option value="5">5</option> 
   <option value="10">10</option> 
</select> Desde el elemento <input id="pag2" class="form-control"></input>
</div>
<button id="ver" class="btn btn-info">Ver Todos</button>
<button id="new" class="btn btn-info">Añadir</button>
<button id="edit" class="btn btn-info">Editar</button>
<button id="remove" class="btn btn-info">Borrar</button>
<button id="buscar" class="btn btn-info">Buscar</button>
<button id="removeall" class="btn btn-info">Borrar Todo</button>
<button id="loadInitialData" class="btn btn-info">Load Inital Data</button>


<table id="location" class="table">
	<thead>
    <tr>
		<th>Countries</th>
        <th>Year</th>
		<th>Petroleum Cost</th>
		<th>Electric Cost</th>
		<th></th>
		<th></th>
    </tr>
	</thead>
</table>
</div>




	
	<script>
		$("#loadInitialData").click(function(){

        var apikey = $("#apikey").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/loadInitialData?apikey="+apikey,
            type:"GET",
            contentType : "application/json"

   		     });
  		});


  		$("#buscar").click(function(){

  		var apikey = $("#apikey").val();
        var year = $("#year").val();
        var country = $("#country").val();
        var desde = $("#desde").val();
        var hasta = $("#hasta").val();
        var pag = $("#pag").val();
        var pag2 = $("#pag2").val();

      
 	 if(country == "" && year != "" && desde == "" && hasta == ""){
			$.ajax(
			{
				type: "GET",
				url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed/' + year +'?apikey='+apikey + "&offset=" + pag2 + "&limit="+ pag,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });

		}else if(year == "" && country !="" && desde == "" && hasta == ""){
			$.ajax(
			{
				type: "GET",
				url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed/' + country +'?apikey='+apikey + "&offset=" + pag2 + "&limit="+ pag,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });

		}else if (desde == "" && hasta == "" && country != "" && year != ""){
			$.ajax(
			{
				type: "GET",
				url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey + "&offset=" + pag2 + "&limit="+ pag,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });
		}else if (desde != "" && hasta != "" && country != "" && year !=""){
			$.ajax(
			{
				type: "GET",
				url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey+ "&from="+desde + "&to="+hasta + "&offset=" + pag2 + "&limit="+ pag,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });
		}else if (desde != "" && hasta != "" && country == "" && year ==""){
			$.ajax(
			{
				type: "GET",
				url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/?apikey="+apikey+ "&from="+desde + "&to="+hasta + "&offset=" + pag2 + "&limit="+ pag,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });

		}else if(country == "" && year == "" && desde == "" && hasta == ""){
			$.ajax(
			{
				type: "GET",
				url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed/?apikey='+apikey + "&offset=" + pag2 + "&limit="+ pag ,
				data: "{}",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				cache: false,
				success: function (data) {
					var trHTML = '';

				$.each(data, function (i, item) {
					trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
				});

				$('#location').append(trHTML);
				},
				error: function (msg) {
					alert(msg.responseText);
				}
	   		 });
		}

	});

      

  		$("#new").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();
        var petroleum_cost = $("#petroleum_cost").val();
        var electric_cost = $("#electric_cost").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/?apikey="+apikey,
            type:"POST",
            data: '{"country":"'+country+'","year":'+year+',"petroleum_cost":'+petroleum_cost+',"electric_cost":'+electric_cost+'}',
            contentType : "application/json"

   		     });
  		});

  		$("#edit").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();
        var petroleum_cost = $("#petroleum_cost").val();
        var electric_cost = $("#electric_cost").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey,
            type:"PUT",
            data: '{"country":"'+country+'","year":'+year+',"petroleum_cost":'+petroleum_cost+',"electric_cost":'+electric_cost+'}',
            contentType : "application/json"

   		     });
  		});



  		$("#remove").click(function(){

        var apikey = $("#apikey").val();
        var country = $("#country").val();
        var year = $("#year").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/" + country + "/" + year + "?apikey="+apikey,
            type:"DELETE",
            contentType : "application/json"

   		     });
  		});


 		$("#removeall").click(function(){

        var apikey = $("#apikey").val();

        $.ajax({
            url:"https://sos-2016-13.herokuapp.com/api/v1/consumed/?apikey="+apikey,
            type:"DELETE",
            contentType : "application/json"

   		     });
  		});

		$("#ver").click(function(){

		var apikey = $("#apikey").val();

		$.ajax(
		{
			type: "GET",
			url: 'https://sos-2016-13.herokuapp.com/api/v1/consumed?apikey='+apikey,
			data: "{}",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			cache: false,
			success: function (data) {
				var trHTML = '';

			$.each(data, function (i, item) {
				trHTML += '<thead><tr><td>' + item.country + '</td><td>' + item.year + '</td><td>' + item.petroleum_cost + '</td><td>' + item.electric_cost + '</td><td><a href=""><img src="edit.ico" width="15" height="15"></a></td><td><a href="" ><img src="remove.png" width="15" height="15"></a></td></tr></thead>';
			});

			$('#location').append(trHTML);
			},
			error: function (msg) {
				alert(msg.responseText);
			}



   		 });
	});


	</script>


</body>
</html>